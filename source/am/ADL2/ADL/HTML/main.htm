<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 7.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="main.css" CHARSET="UTF-8" TYPE="text/css">
<TITLE> 8	ADL - Archetype Definition Language</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<H4 CLASS="Hdr1">
<A NAME="pgfId-1117914"></A>ADL - Archetype Definition Language<DIV>
<IMG SRC="main-1.png">
</DIV>
</H4>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1143456"></A>Introduction</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1148879"></A>This section describes whole ADL artefacts. The relationship of the cADL-encoded <CODE CLASS="Code">
definition</CODE>
 section and the ODIN-encoded <CODE CLASS="Code">
terminology</CODE>
 section is discussed in detail. In this section, only standard ADL (i.e. the standard cADL constructs and types described so far) is assumed. </P>
<P CLASS="Body">
<A NAME="pgfId-1149150"></A>Some syntax valdity rules are defined, but validity in general is defined by the rules stated in the AOM specification, which can be checked by a compiler as soon as an AOM structure is parsed from an ADL document (or other serialsiation format).</P>
<P CLASS="Body">
<A NAME="pgfId-1148996"></A>The general structure of ADL artefacts is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1149001"></A>(([flat] archetype | template | template_overlay) | </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149002"></A>			operational_template) (qualifiers)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149003"></A>	id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136603"></A>[specialize </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136604"></A>	parent_id]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141549"></A>language</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141550"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136621"></A>description </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136622"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136630"></A>definition </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136631"></A>	cADL</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141876"></A>[rules </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141877"></A>	assertions]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136635"></A>terminology </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136636"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146885"></A>[annotations </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146886"></A>	ODIN]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140125"></A>[revision_history </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140126"></A>	ODIN]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148627"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1149083"></A>An ADL source template has the structure (‘template’ keyword; must be specialised):</P>
<PRE CLASS="CCode"><A NAME="pgfId-1149084"></A>[flat] template (qualifiers)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149086"></A>	id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149029"></A>specialize </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149030"></A>	parent_id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149033"></A>language</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149034"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149035"></A>description </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149036"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149037"></A>definition </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149038"></A>	cADL</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149039"></A>[rules </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149040"></A>	assertions]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149041"></A>terminology </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149042"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149043"></A>[annotations </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149044"></A>	ODIN]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149045"></A>[revision_history </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149046"></A>	ODIN section]</PRE>
<P CLASS="Body">
<A NAME="pgfId-1148590"></A>An ADL template overlay has the structure shown below (‘template_overlay’ keyword, must be specialised; minimal sections):</P>
<PRE CLASS="CCode"><A NAME="pgfId-1148591"></A>template_overlay (qualifiers)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148592"></A>	id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148593"></A>specialize </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148594"></A>	parent_id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148601"></A>definition </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148602"></A>	cADL</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148605"></A>terminology </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148606"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149111"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1148746"></A>The structure of an operational template expressed in native ADL is as follows (‘operational_template’ keyword; full flattened structure, including component_ontologies section):</P>
<PRE CLASS="CCode"><A NAME="pgfId-1148747"></A>operational_template (qualifiers)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148748"></A>	template_id</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148753"></A>language</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148754"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148755"></A>description </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148756"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148757"></A>definition </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148758"></A>	cADL</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148759"></A>[rules </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148760"></A>	assertions]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148761"></A>terminology </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148762"></A>	ODIN</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148763"></A>[annotations </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148808"></A>	ODIN]</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148809"></A>component_ontologies </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148810"></A>	ODIN</PRE>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1148811"></A>File-naming Convention</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1148812"></A>Up until ADL 1.4, archetypes were expressed in ‘flat’ form ADL and were saved in files with the extension ‘.adl’. These are now treated as legacy flat format files. Beginning with ADL 1.5, the source file format of an archetype is the ‘differential’ form, with the extension ‘.adls’. The flat format being generated by tools, and now has the extension ‘.adlf’. </P>
<P CLASS="Body">
<A NAME="pgfId-1148480"></A>For specialised archetypes, differential form follows the object-oriented convention and only includes overridden or new elements but not unchanged inherited elements. Inherited elements are determined by compiling and ‘flattening’ a differential archetype with respect to the parent archetypes in its <EM CLASS="Emphasis">
inheritance lineage</EM>
. </P>
<P CLASS="Body">
<A NAME="pgfId-1148487"></A>For top-level archetypes the full structure is included in the differential file, but internal references, where they exist, are expanded out in the flat form. </P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1146387"></A>Basics</H5>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1143695"></A>8.3.1	Keywords</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1130696"></A>ADL has a small number of keywords which are reserved for use in archetype declarations, as follows:</P>
<UL>
<LI CLASS="LstU1">
<A NAME="pgfId-1130707"></A><CODE CLASS="Code">
archetype, template, template_overlay, operational_template,</CODE>
</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1147263"></A><CODE CLASS="Code">
specialise</CODE>
/<CODE CLASS="Code">
specialize</CODE>
, </LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1147274"></A><CODE CLASS="Code">
concept</CODE>
,</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1143556"></A><CODE CLASS="Code">
language</CODE>
,</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1130842"></A><CODE CLASS="Code">
description</CODE>
, <CODE CLASS="Code">
definition</CODE>
, <CODE CLASS="Code">
rules</CODE>
, <CODE CLASS="Code">
terminology</CODE>
</LI>
</UL>
<P CLASS="Body">
<A NAME="pgfId-1130747"></A>All of these words can safely appear as identifiers in the <CODE CLASS="Code">
definition</CODE>
 and <CODE CLASS="Code">
terminology</CODE>
 sections. </P>
<P CLASS="Body">
<A NAME="pgfId-1146903"></A>Deprecated keywords include:</P>
<UL>
<LI CLASS="LstU1">
<A NAME="pgfId-1146904"></A><CODE CLASS="Code">
invariant -- replaced by ‘rules’</CODE>
</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1151842"></A><CODE CLASS="Code">
ontology -- replaced by ‘terminology’</CODE>
</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1151860"></A><CODE CLASS="Code">
concept -- obsolete</CODE>
</LI>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1134448"></A>8.3.2	Artefact declaration</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1147292"></A>The first word in a source ADL archetype declares the artefact type, and is one of the following keywords:</P>
<UL>
<LI CLASS="LstV1">
<A NAME="pgfId-1147393"></A>‘archetype’: signifies an archetype;</LI>
<LI CLASS="LstV1">
<A NAME="pgfId-1147410"></A>‘template’: signifies a template;</LI>
<LI CLASS="LstV1">
<A NAME="pgfId-1147417"></A>‘template_overlay’: signifies an overlay component of a template.</LI>
</UL>
<P CLASS="Body">
<A NAME="pgfId-1149180"></A>The flattened form of any of the above types starts with the keyword ‘flat’ followed by the artefact type.</P>
<P CLASS="Body">
<A NAME="pgfId-1149194"></A>A fourth artefact type is also possible.</P>
<UL>
<LI CLASS="LstV1">
<A NAME="pgfId-1147424"></A>‘operational_archetype’: signifies an operational archetype, generated by flattening a template.</LI>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1147284"></A>8.3.3	Node Identifier Codes</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1134449"></A>In the <CODE CLASS="Code">
definition</CODE>
 section of an ADL archetype, a specific set of codes is used as node identifiers. Identifier codes always appear in brackets (<CODE CLASS="Code">
[]</CODE>
), and begin with the ‘id’ prefix. Specialisations of locally coded concepts have the same root, followed by ‘dot’ extensions, e.g. <CODE CLASS="Code">
[id10.2]</CODE>
. From a terminology point of view, these codes have no implied semantics - the ‘dot’ structuring is used as an optimisation on node identification.</P>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1150582"></A>In ADL 1.4 and transitional forms of ADL 1.5, ‘at’ codes were used as node identifiers. Within top-level archetypes, the code numbers were 0-padded to make up a 4-digit code, e.g. ‘at0004’. In ADL 2, all such codes are replaced by an ‘id’ code whose number is one greater than the original at-code number. This numeric change is to accommodate the conversion of the root identifier code at0000 to id1 rather than id0.</P>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1150549"></A>8.3.4	Local Term Codes</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1150550"></A>In the <CODE CLASS="Code">
definition</CODE>
 section of an ADL archetype, a second set of codes is used for terms denoting constraints on coded items. Term codes are either local to the archetype, or from an external lexicon. This means that the archetype description is the same in all languages, and is available in any language that the codes have been translated to. All term codes are shown in brackets (<CODE CLASS="Code">
[]</CODE>
) and are prefixed with “at”, e.g. <CODE CLASS="Code">
at10</CODE>
. Codes of any length are acceptable in ADL archetypes. Specialisations of locally coded concepts have the same root, followed by ‘dot’ extensions, e.g. <CODE CLASS="Code">
at10.2</CODE>
. From a terminology point of view, these codes have no implied semantics - the ‘dot’ structuring is used as an optimisation on node identification.</P>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1150613"></A>In ADL 1.4 and transitional forms of ADL 1.5, 0-padded ‘at’ codes were used within top-level archetypes. In ADL 2, all such codes are reformatted to remove the 0-padding.</P>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1139029"></A>8.3.5	<A NAME="70808"></A>Local Constraint Codes</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1118866"></A>A third kind of local code is used to stand for constraints on code text items in the body of the archetype. Although these could be included in the main archetype body, because they are language- and/or terminology-sensitive, they are defined in the terminology section, and referenced by codes prefixed by “ac”, e.g. <CODE CLASS="Code">
[ac9]</CODE>
.</P>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1150635"></A>In ADL 1.4 and transitional forms of ADL 1.5, 0-padded ‘ac’ codes were used within top-level archetypes. In ADL 2, all such codes are reformatted to remove the 0-padding.</P>
</UL>
</DIV>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1118083"></A>Archetype Identification Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1149271"></A>This section introduces the archetype with the keyword ‘archetype’ ‘template’, ‘template_overlay’ or ‘operational_archetype’, followed by a number of items of meta-data in parentheses, and on the next line, a human-readable archetype identifier. The following shows an identification section with all possible meta-data items.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1152027"></A>archetype (adl_version=2.0.5; </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152048"></A>			provenance_id=15E82D77-7DB7-4F70-8D8E-EED6FF241B2D;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152077"></A>			build_id=E163E472-3E90-409C-9803-0668A7DA48CE;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152107"></A>			generated;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152114"></A>			controlled)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152152"></A>	openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152144"></A>&nbsp;</PRE>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1152187"></A>8.4.1	ADL Version Indicator</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1152188"></A>An ADL version identifier is mandatory in all archetypes, and is expressed as a string of the form <CODE CLASS="Code">
adl_version=N.M</CODE>
, or <CODE CLASS="Code">
N.M.P</CODE>
, where <CODE CLASS="Code">
N.M[.P]</CODE>
 is the ADL release identifier.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1151963"></A>8.4.2	Machine Identifiers</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151964"></A>A unique identifier for the archetype in the form of a GUID can be specified using the syntax below:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1151965"></A>archetype (adl_version=2.0.5; uid=15E82D77-7DB7-4F70-8D8E-EED6FF241B2D)</PRE>
<P CLASS="Body">
<A NAME="pgfId-1151966"></A>This identifier is set at initial creation or at any time later, and nevre subsequently changes. It acts as an identifier for the physical artefact, regardless of what semantics are changed, including changes to the constituent parts of the multi-axial identifier.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1149544"></A>8.4.3	Namespaces</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1146429"></A>A namespaced archetype will have an identification section like the following examples:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1149318"></A>archetype (adl_version=2.0.5)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149319"></A>	br.gov.saude::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149348"></A>&nbsp;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149388"></A>template (adl_version=2.0.5)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149389"></A>	uk.org.primary_care::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149367"></A>&nbsp;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149400"></A>archetype (adl_version=2.0.5)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149368"></A>	org.openehr::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149359"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1149482"></A>Namespaces are used to distinguish locally created artefacts representing a given concept (such as ‘haematology result’) from an artefact created elsewhere intended to represent the same concept.</P>
<P CLASS="Body">
<A NAME="pgfId-1149489"></A>Once a namespace is attached to an archetype, it is considered a part of the identifier, and never changed, even if the archetype moves to a new publishing organisation. This ensures the constant relationship between archetypes and the data created using them.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1149557"></A>8.4.4	Human Readable Archetype Identifier</H6>
<P CLASS="Body">
<A NAME="pgfId-1152230"></A>The archetype identifier may include a namespace, in the form of a reverse domain name, which denotes the original authoring organisation. The lack of a namespace in the identifier indicates an ad hoc, uncontrolled artefact, not formally associated with any organisation, typical for experimental archetypes, and pre-ADL 1.5 archetypes not yet upgraded to have a namespace. The main part of the identifier is multi-axial concept identifier.</P>
<P CLASS="Body">
<A NAME="pgfId-1152231"></A>A typical identification sectionfor an ad hoc archetype is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1152232"></A>archetype (adl_version=2.0.5)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152233"></A>	openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152234"></A>&nbsp;</PRE>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1152235"></A>In ADL 1.4 and transitional forms of ADL 1.5, archetype identifiers included only a single version number, and this typically started at 1. Tools that deal with older archetypes should accept these identifiers, and convert the version part to ‘v1.0.0’ or any other appropriate identifier, obeying the openEHR Artefact Knowledge Identification specification.</P>
</UL>
<P CLASS="BodyFirst">
<A NAME="pgfId-1152222"></A>The multi-axial archetype identifier identifies archetypes in a global concept space within a given namespace. It is also known as an ‘ontological’ identifier, since the concept space can be understood as an ontology of informational concepts on which the archetypes are based. The syntax of the identifier is described in the Identification section of the openEHR Support IM specification. The structure of the concept space is essentially two-level, with the first level being a reference model class (e.g. openEHR <CODE CLASS="Code">
OBSERVATION</CODE>
 class) and the second being a domain concept (e.g. ‘haematology result’).</P>
<P CLASS="Body">
<A NAME="pgfId-1149607"></A>Because namespaces are usually treated hierarchically, higher level namespaces (e.g. ‘.org’ domains) are assumed to be includable by more local namespaces, with the result that the concept definition space is inherited as well.</P>
<P CLASS="Body">
<A NAME="pgfId-1150183"></A>The semantics of the ontological identifier are described in detail in the <A HREF="http://www.openehr.org/releases/trunk/architecture/am/knowledge_id_system.pdf" CLASS="URL">Knowledge Artefact Identification specification</A>.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1149417"></A>8.4.5	Specialised Archetype Identification</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1149708"></A>The archetype identifier of any specialised archetype, including all templates, follows the same rules as for non-specialised archetypes.</P>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1149709"></A>Note: in previous versions of ADL, the archetype identifier of a specialised archetype had a concept part that consisted of the concept part of the parent followed by ‘-’ and a further specialised concept. For example, <CODE CLASS="Code">
openEHR-EHR-OBSERVATION.haematology-cbc.v1</CODE>
 was a valid child of <CODE CLASS="Code">
openEHR-EHR-OBSERVATION.haematology.v1</CODE>
. This restriction is no longer the case. The previous style of identifier is still legal, but the ‘-’ no longer has any significance.</P>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1151485"></A>8.4.6	Version Identifiers</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151486"></A>ADL 2 Archetypes contain 3-part version identifiers, with optional qualifiers, following the openEHR Artefact Knowledge Identification specification. Examples below:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1151488"></A>	br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151491"></A>	br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15-alpha.45</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151494"></A>	br.ms::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151495"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1151497"></A>The version identifier variants are summarised as follows:</P>
<UL>
<LI CLASS="LstU1">
<A NAME="pgfId-1151550"></A><CODE CLASS="Code">
N.M.P</CODE>
 - 3-part version id with no qualifier indicates major.minor.path version</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1151560"></A><CODE CLASS="Code">
N.M.P-alpha.N</CODE>
 - a <CODE CLASS="Code">
-alpha.N</CODE>
 qualifier indicates uncontrolled changes on <CODE CLASS="Code">
N.M.P</CODE>
, leading to a new version that is yet to be decided</LI>
<LI CLASS="LstU1">
<A NAME="pgfId-1151567"></A><CODE CLASS="Code">
N.M.P-rc.N</CODE>
 - a <CODE CLASS="Code">
-rc.N</CODE>
 qualifier indicates a release candidate.</LI>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1149710"></A>8.4.7	Validity</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1149711"></A>The following syntax validity rule applies in the identification section:</P>
<P CLASS="ValidityRule">
<A NAME="pgfId-1147456"></A>SARID: archetype identifier validity. the identifier of the artefact must conform to the ARCHETYPE_ID identifier syntax defined in the openEHR.Support IM Specification.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1146369"></A>8.4.8	Generated Indicator</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1146370"></A>A flag indicating whether the archetype was generated or authored can be included after the version, as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1146371"></A>archetype (adl_version=2.0.5; generated)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146372"></A>	org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</PRE>
<P CLASS="Body">
<A NAME="pgfId-1151881"></A>This marker is used to support the migration to differential archetype representation introduced in ADL 1.5, to enable proper representation of specialised archetypes. The ‘generated’ marker can be used on specialised archetypes - i.e. ADL 1.5 style .adls files - generated from flat archetypes - ADL 1.4 .adl files - and also in flat archetypes generated from differential files, by an inheritance-flattening process.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1152092"></A>8.4.9	Controlled Indicator</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1152093"></A>A flag indicating whether the archetype is change-controlled or not can be included after the version, as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1152094"></A>archetype (adl_version=2.0.5; controlled)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1152095"></A>	org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</PRE>
<P CLASS="Body">
<A NAME="pgfId-1152096"></A>This flag may have the two values “controlled” and “uncontrolled” only, and is an aid to software. Archetypes that include the “controlled” flag should have the revision history section included, while those with the “uncontrolled” flag, or no flag at all, may omit the revision history. This enables archetypes to be privately edited in an early development phase without generating large revision histories of little or no value.</P>
</DIV>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1151886"></A>Specialise Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151887"></A>This optional section indicates that the archetype is a specialisation of some other archetype, whose identity must be given. Only one specialisation parent is allowed, i.e. an archetype cannot ‘multiply-inherit’ from other archetypes. An example of declaring specialisation is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1134499"></A>archetype (adl_version=2.0.5)</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134500"></A>	openEHR-EHR-OBSERVATION.cbc.v1</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134501"></A>specialise </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1127330"></A>	openEHR-EHR-OBSERVATION.haematology.v1</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1127322"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1118749"></A>Here the identifier of the new archetype is derived from that of the parent by adding a new section to its domain concept section. See the <CODE CLASS="Code">
ARCHETYPE_ID</CODE>
 definition in the identification package in the openEHR Support IM specification.</P>
<P CLASS="Body">
<A NAME="pgfId-1127355"></A>Note that both the US and British English versions of the word “specialise” are valid in ADL.</P>
<P CLASS="Body">
<A NAME="pgfId-1147482"></A>The following syntax validity rule applies in the specialisation section:</P>
<P CLASS="ValidityRule">
<A NAME="pgfId-1147483"></A>SASID: archetype specialisation parent identifier validity. for specialised artefacts, the identifier of the specialisation parent must conform to the ARCHETYPE_ID identifier syntax defined in the openEHR Support IM Specification.</P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1118088"></A>Language Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1140303"></A>The <CODE CLASS="Code">
language</CODE>
 section includes meta-data describing the original language in which the archetype was authored (essential for evaluating natural language quality), and the total list of languages available in the archetype. There can be only one <CODE CLASS="Code">
original_language</CODE>
. The <CODE CLASS="Code">
translations</CODE>
 list must be updated every time a translation of the archetype is undertaken. The following shows a typical example.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1140295"></A>language</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140286"></A>	original_language = &lt;[iso_639-1::en]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141409"></A>	translations = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141428"></A>		[“de”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144299"></A>			language = &lt;[iso_639-1::de]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141410"></A>			author = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144248"></A>				[“name”] = &lt;&quot;Frederik Tyler&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144236"></A>				[“email”] = &lt;&quot;freddy@something.somewhere.co.uk&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144251"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141411"></A>			accreditation = &lt;&quot;British Medical Translator id 00400595”&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141429"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141563"></A>		[“ru”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144315"></A>			language = &lt;[iso_639-1::ru]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141564"></A>			author = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144259"></A>				[“name”] = &lt;&quot;Nina Alexandrovna&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144274"></A>				[“organisation”] = &lt;&quot;Dostoevsky Media Services&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144257"></A>				[“email”] = &lt;&quot;nina@translation.dms.ru&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144272"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141565"></A>			accreditation = &lt;&quot;Russian Translator id 892230-3A”&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141412"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1144283"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141407"></A>&nbsp;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1141458"></A>Archetypes must always be translated completely, or not at all, to be valid. This means that when a new translation is made, every language dependent section of the <CODE CLASS="Code">
description</CODE>
 and <CODE CLASS="Code">
terminology</CODE>
 sections has to be translated into the new language, and an appropriate addition made to the <CODE CLASS="Code">
translations</CODE>
 list in the language section.</P>
<P CLASS="Note">
<A NAME="pgfId-1144326"></A>Note: some non-conforming ADL tools in the past created archetypes without a language section, relying on the terminology section to provide the original_language (there called primary_language) and list of languages (languages_available). In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.</P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1140283"></A>Description Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1118533"></A>The <CODE CLASS="Code">
description</CODE>
 section of an archetype contains descriptive information, or what some people think of as document “meta-data”, i.e. items that can be used in repository indexes and for searching. The ODIN syntax is used for the description, as in the following example.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1133521"></A>description</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140398"></A>	original_author = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141891"></A>		[“name”] = &lt;&quot;Dr J Joyce&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141913"></A>		[“organisation”] = &lt;&quot;NT Health Service&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140517"></A>		[“date”] = &lt;2003-08-03&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141920"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140496"></A>	lifecycle_state =				 &lt;&quot;initial&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140444"></A>	resource_package_uri =				 </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140459"></A>		&lt;&quot;www.aihw.org.au/data_sets/diabetic_archetypes.html&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140463"></A>&nbsp;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1133527"></A>	details = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140807"></A>		[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145570"></A>			language = &lt;[iso_639-1::en]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1133529"></A>			purpose =		 &lt;&quot;archetype for diabetic patient review&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140477"></A>			use = &lt;&quot;used for all hospital or clinic-based diabetic reviews, </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140547"></A>				including first time. Optional 				sections are removed according</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140550"></A>				to the particular review&quot;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146930"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140511"></A>			misuse = &lt;&quot;not appropriate for pre-diagnosis use&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141926"></A>			original_resource_uri =				 </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141927"></A>				&lt;&quot;www.healthdata.org.au/data_sets/									diabetic_review_data_set_1.html&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140481"></A>			other_details =		 &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1133530"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140524"></A>		[“de”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145560"></A>			language = &lt;[iso_639-1::de]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142614"></A>			purpose =		 &lt;&quot;Archetyp für die Untersuchung von Patienten</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140525"></A>						mit Diabetes&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142624"></A>			use = &lt;&quot;wird benutzt für alle Diabetes-Untersuchungen im</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142625"></A>					Krankenhaus, inklusive der ersten Vorstellung. Optionale</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142635"></A>					Abschnitte werden in Abhängigkeit von der speziellen</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142639"></A>					Vorstellung entfernt.&quot;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142641"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142649"></A>			misuse = &lt;&quot;nicht geeignet für Benutzung vor Diagnosestellung&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141934"></A>			original_resource_uri =				 </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141935"></A>				&lt;&quot;www.healthdata.org.au/data_sets/									diabetic_review_data_set_1.html&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140529"></A>			other_details =		 &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140825"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140530"></A>	&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1133595"></A>A number of details are worth noting here. Firstly, the free hierarchical structuring capability of ODIN is exploited for expressing the ‘deep’ structure of the <CODE CLASS="Code">
details</CODE>
 section and its subsections. Secondly, the ODIN qualified list form is used to allow multiple translations of the <CODE CLASS="Code">
purpose</CODE>
 and <CODE CLASS="Code">
use</CODE>
 to be shown. Lastly, empty items such as <CODE CLASS="Code">
misuse</CODE>
 (structured if there is data) are shown with just one level of empty brackets. The above example shows meta-data based on the openEHR Archetype Object Model (AOM).</P>
<P CLASS="Body">
<A NAME="pgfId-1145481"></A>The <CODE CLASS="Code">
description</CODE>
 section is technically optional according to the AOM, but in any realistic use of ADL for archetypes, it will be required. A minimal description section satisfying to the AOM is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1145489"></A>description</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145490"></A>	original_author = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145491"></A>		[“name”] = &lt;&quot;Dr J Joyce&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145492"></A>		[“organisation”] = &lt;&quot;NT Health Service&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145493"></A>		[“date”] = &lt;2003-08-03&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145494"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145495"></A>	lifecycle_state =				 &lt;&quot;initial&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145499"></A>	details = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145500"></A>		[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145550"></A>			language = &lt;[iso_639-1::en]&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145501"></A>			purpose =		 &lt;&quot;archetype for diabetic patient review&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145509"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145523"></A>	&gt;</PRE>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1117927"></A>Deprecated Sections</H5>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1149678"></A>8.8.1	Concept Section</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1149679"></A>A ‘concept’ section was required up until ADL 1.4. In ADL 1.5, the concept section is deprecated, but allowed, enabling ADL 1.4 archetypes to be treated as valid. It will be removed in a future version of ADL, since it is completely redundant.</P>
<P CLASS="BodyFirst">
<A NAME="pgfId-1149680"></A>All archetypes represent some real world concept, such as a “patient”, a “blood pressure”, or an “ante-natal examination”. The concept is always coded, ensuring that it can be displayed in any language the archetype has been translated to. A typical <CODE CLASS="Code">
concept</CODE>
 section is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1149681"></A>concept</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1149682"></A>	[at0000]				-- haematology result</PRE>
<P CLASS="Body">
<A NAME="pgfId-1149683"></A>In this concept definition, the term definition of <CODE CLASS="Code">
[at0000]</CODE>
 is the proper description corresponding to the “haematology-cbc” section of the archetype identifier above.</P>
<P CLASS="Body">
<A NAME="pgfId-1149684"></A>The following syntax validity rule applies to the concept section, if present, allowing parsers to correctly ignore it:</P>
<P CLASS="ValidityRule">
<A NAME="pgfId-1149685"></A>SACO: archetype concept validity: if a concept section is present, it must consist of the ‘concept’ keyword and a single local term.</P>
</DIV>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1149658"></A>Definition Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1118708"></A>The <CODE CLASS="Code">
definition</CODE>
 section contains the main formal definition of the archetype, and is written in the Constraint Definition Language (cADL). A typical <CODE CLASS="Code">
definition</CODE>
 section is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1118737"></A>definition</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118715"></A>	OBSERVATION[id1] ∈ {   									-- blood pressure measurement</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118716"></A>		name ∈ { 								-- any synonym of BP</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118717"></A>			DV_CODED_TEXT[id2] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118718"></A>				defining_code ∈ { </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118719"></A>					CODE_PHRASE[id3] ∈ {[ac1]}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118720"></A>				}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118721"></A>			}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1118722"></A>		}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134528"></A>		data ∈ {			</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134529"></A>			HISTORY[id4] ∈ {														-- history</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134531"></A>				events cardinality ∈ {1..*} ∈ { </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134532"></A>					POINT_EVENT[id5] occurrences ∈ {0..1} ∈ {			-- baseline</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134533"></A>						name ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134534"></A>							DV_CODED_TEXT[id6] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134535"></A>								defining_code ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134536"></A>									CODE_PHRASE[id7] ∈ {[ac2]}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134537"></A>								}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134538"></A>							}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1138932"></A>						}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1138933"></A>						data ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1138934"></A>							ITEM_LIST[id8] ∈ {								-- systemic arterial BP</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134544"></A>								items cardinality ∈ {2..*} ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134545"></A>									ELEMENT[id9] ∈ {									-- systolic BP</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134546"></A>										name ∈ {					-- any synonym of 'systolic'</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134547"></A>											DV_CODED_TEXT[id10] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134548"></A>												defining_code ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134549"></A>													CODE_PHRASE[id11] ∈ {[ac2]}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134550"></A>												}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134551"></A>											}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134552"></A>										}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134553"></A>										value ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134554"></A>											DV_QUANTITY[id12] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134555"></A>												magnitude ∈ {0..1000}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1138910"></A>												property ∈ {[properties::944]}	 																		-- “pressure”</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1138911"></A>												units ∈ {[units::387]}						-- “mm[Hg]”</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134558"></A>											}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134559"></A>										}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134560"></A>									} </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135787"></A>									ELEMENT[id79] ∈ {								-- diastolic BP</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135788"></A>										name ∈ {					-- any synonym of 'diastolic'</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135789"></A>											DV_CODED_TEXT[id14] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135790"></A>												defining_code ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135791"></A>													CODE_PHRASE[id15] ∈ {[ac3]}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135792"></A>												}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135793"></A>											}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135794"></A>										}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135795"></A>										value ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135796"></A>											DV_QUANTITY[id16] ∈ {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135797"></A>												magnitude ∈ {0..1000}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135798"></A>												property ∈ {[properties::944]}	 																		-- “pressure”</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135799"></A>												units ∈ {[units::387]}						-- “mm[Hg]”</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135800"></A>											}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135801"></A>										}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135802"></A>									} </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134577"></A>									ELEMENT[id17] occurrences ∈ {0..*} ∈ {*}	</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1135828"></A>																	-- unknown new item</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134578"></A>								}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134579"></A>							...</PRE>
<P CLASS="Body">
<A NAME="pgfId-1134518"></A>This definition expresses constraints on instances of the types <CODE CLASS="Code">
ENTRY</CODE>
, <CODE CLASS="Code">
HISTORY</CODE>
, <CODE CLASS="Code">
EVENT</CODE>
, <CODE CLASS="Code">
ITEM_LIST</CODE>
, <CODE CLASS="Code">
ELEMENT</CODE>
, <CODE CLASS="Code">
QUANTITY</CODE>
, and <CODE CLASS="Code">
CODED_TEXT</CODE>
 so as to allow them to represent a blood pressure measurement, consisting of a history of measurement events, each consisting of at least systolic and diastolic pressures, as well as any number of other items (expressed by the <CODE CLASS="Code">
[at9000]</CODE>
 “any” node near the bottom).</P>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1145660"></A>8.9.1	Design-time and Run-time paths</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1145661"></A>All archetype object constraint nodes require a node identifier. When data are created according to the <CODE CLASS="Code">
definition</CODE>
 section of an archetype, the archetype node identifiers can be written into the data, providing a reliable way of finding data nodes, regardless of what other runtime names might have been chosen by the user for the node in question. There are two reasons for doing this. Firstly, querying cannot rely on runtime names of nodes (e.g. names like “sys BP”, “systolic bp”, “sys blood press.” entered by a doctor are unreliable for querying); secondly, it allows runtime data retrieved from a persistence mechanism to be re-associated with the cADL structure which was used to create it.</P>
<P CLASS="Body">
<A NAME="pgfId-1145662"></A>An example which shows the difference between design-time meanings associated with node identifiers and runtime names is the following, from a <CODE CLASS="Code">
SECTION</CODE>
 archetype representing the problem/SOAP headings (a simple heading structure commonly used by clinicians to record patient contacts under top-level headings corresponding to the patient’s problem(s), and under each problem heading, the headings “subjective”, “objective”, “assessment”, and “plan”).</P>
<PRE CLASS="CCode"><A NAME="pgfId-1145663"></A>	SECTION[id1] matches {													-- problem</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145664"></A>		name matches {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145665"></A>			DV_CODED_TEXT[id2] matches {</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145666"></A>				defining_code matches {[ac1]}										-- any clinical problem type</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145667"></A>			}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145668"></A>		}</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147896"></A>	}</PRE>
<P CLASS="Body">
<A NAME="pgfId-1145669"></A>	In the above, the node identifier <CODE CLASS="Code">
[id1]</CODE>
 is assigned a meaning such as “clinical problem” in the archetype terminology section. The subsequent lines express a constraint on the runtime <EM CLASS="Emphasis">
name</EM>
 attribute, using the internal code <CODE CLASS="Code">
[ac1]</CODE>
. The constraint <CODE CLASS="Code">
[ac1]</CODE>
 is also defined in the archetype terminology section with a formal statement meaning “any clinical problem type”, which could clearly evaluate to thousands of possible values, such as “diabetes”, “arthritis” and so on. As a result, in the runtime data, the node identifier corresponding to “clinical problem” and the actual problem type chosen at runtime by a user, e.g. “diabetes”, can both be found. This enables querying to find all nodes with meaning “problem”, or all nodes describing the problem “diabetes”. Internal <CODE CLASS="Code">
[acNNNN]</CODE>
 codes are described in <A HREF="main.htm#70808" CLASS="XRef">See Local Constraint Codes</A>.</P>
</DIV>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1141750"></A>Rules Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1141818"></A>The <CODE CLASS="Code">
rules</CODE>
 section in an ADL archetype introduces assertions which relate to the entire archetype, and can be used to make statements which are not possible within the block structure of the <CODE CLASS="Code">
definition</CODE>
 section. Any constraint which relates more than one property to another is in this category, as are most constraints containing mathematical or logical formulae. Rules are expressed in the archetype assertion language, described in <A HREF="assertion.htm#68334" CLASS="XRef">See Assertions</A>.</P>
<P CLASS="Body">
<A NAME="pgfId-1141764"></A>An assertion is a first order predicate logic statement which can be evaluated to a boolean result at runtime. Objects and properties are referred to using paths. </P>
<P CLASS="Body">
<A NAME="pgfId-1141766"></A>The following simple example says that the speed in kilometres of some node is related to the speed-in-miles by a factor of 1.6:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1141767"></A>rules</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141861"></A>	validity: /speed[id2]/kilometres[id13]/magnitude =</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1142593"></A>				/speed[id4]/miles[id14]/magnitude * 1.6</PRE>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1141863"></A>Terminology Section</H5>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1148071"></A>8.11.1	ADL 1.4 / 1.5 Version Compatibility</H6>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1147941"></A>In ADL 1.4 archetypes, the terminology section used the following kind of nesting of containers:</P>
</UL>
<PRE CLASS="CCode"><A NAME="pgfId-1147979"></A>	term_definitions = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147966"></A>		[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1150827"></A>			items = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1150828"></A>				[“at0001”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1150829"></A>				[“at0002”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148034"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148027"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148094"></A>	&gt;</PRE>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1148041"></A>This has been replaced in ADL 1.5 archetypes by the proper ODIN nested structures described below, which correspond to the nested Hash&lt;&gt; representational structures defined in the AOM. Tools that generate ADL1.4 style archetypes via archetype ‘flattening’ should output the ADL 1.4 style nesting structure to enable older tools to deal with the output.</P>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1141864"></A>8.11.2	Overview</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1136895"></A>The <CODE CLASS="Code">
terminology</CODE>
 section of an archetype is expressed in ODIN, and is where codes representing node IDs, constraints on text or terms, and bindings to terminologies are defined. Linguistic language translations are added in the form of extra blocks keyed by the relevant language. The following example shows the layout of this section.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1121553"></A>terminology </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121558"></A>	term_definitions = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140850"></A>		[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151317"></A>			[“id1”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1148107"></A>			[“at1”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151359"></A>			[&quot;ac1&quot;] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141379"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140834"></A>		[“de”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151331"></A>			[“id1”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141389"></A>			[“at1”] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151347"></A>			[&quot;ac1&quot;] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140861"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121571"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121609"></A>	term_bindings = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140894"></A>		[“snomed_ct”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151113"></A>			[&quot;id4&quot;] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151095"></A>			[&quot;ac1&quot;] = &lt;...&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121673"></A>			...</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151126"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121617"></A>	&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1121551"></A>The <CODE CLASS="Code">
term_definitions</CODE>
 section is mandatory, and must be defined for each translation carried out.</P>
<UL>
<P CLASS="Deprecated">
<A NAME="pgfId-1151384"></A>In ADL 1.4 the terminology section consisted of potentially 4 parts, i.e. term_definitions, constraint_definitions, term_bindings and constraint_bindings. The former two are now merged into one list, term_definitions, and the latter two into one list, term_bindings.</P>
</UL>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1121883"></A>8.11.3	Term_definitions Section</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1121911"></A>This section is where all archetype local terms (including all at-codes, ac-codes, and at least the id-codes attached to container attribute children) are defined. The following example shows an extract from the English and German term definitions for the archetype local terms in a problem/SOAP headings archetype. Each term is defined using a structure of name/value pairs, and mustat least include the names “text” and “description”, which are akin to the usual rubric, and full definition found in terminologies like SNOMED-CT. Each term object is then included in the appropriate language list of term definitions, as shown in the example below.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1121975"></A>term_definitions = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140902"></A>	[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140922"></A>		[“id1”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140926"></A>			text = &lt;&quot;problem&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140927"></A>			description = &lt;&quot;The problem experienced by the subject </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140932"></A>				of care to 			which the contained information relates&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140929"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140906"></A>		[“id2”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134340"></A>			text = &lt;&quot;problem/SOAP headings&quot;&gt; </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121977"></A>			description = &lt;&quot;SOAP heading structure for multiple problems&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1134339"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140956"></A>		... </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140958"></A>		[“id3”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140959"></A>			text = &lt;&quot;plan&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121916"></A>			description = &lt;&quot;The clinician's professional advice&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140947"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140948"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140975"></A>[“de”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141010"></A>	[“id1”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141002"></A>			text = &lt;&quot;klinisches Problem&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141003"></A>			description = &lt;&quot;Das Problem des Patienten worauf sich diese \</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141004"></A>						Informationen beziehen&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141005"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140985"></A>	[“id2”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140991"></A>			text = &lt;&quot;Problem/SOAP Schema&quot;&gt; </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140992"></A>			description = &lt;&quot;SOAP-Schlagwort-Gruppierungsschema fuer</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140997"></A>					mehrfache 			Probleme&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140994"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141022"></A>	[“id3”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141026"></A>			text = &lt;&quot;Plan&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141027"></A>			description = &lt;&quot;Klinisch-professionelle Beratung des</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141030"></A>						Pflegenden&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141020"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121917"></A>&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1122157"></A>In some cases, term definitions may have been lifted from existing terminologies (only a safe thing to do if the definitions exactly match the need in the archetype). To indicate where definitions come from, a “provenance” tag can be used, as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1141042"></A>[“id3”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136091"></A>	text = &lt;&quot;plan&quot;&gt;; </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122173"></A>	description = &lt;&quot;The clinician's professional advice&quot;&gt;;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122167"></A>	provenance = &lt;&quot;ACME_terminology(v3.9a)&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141047"></A>&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1122180"></A>Note that this does not indicate a <EM CLASS="Emphasis">
binding</EM>
 to any term, only its origin. Bindings are described in <A HREF="main.htm#39544" CLASS="XRef">See Term_bindings Section</A>.</P>
<P CLASS="BodyFirst">
<A NAME="pgfId-1122184"></A>The <CODE CLASS="Code">
term_definitions</CODE>
 section also includes definitions for archetype-local constraint codes, which are of the form <CODE CLASS="Code">
[acN]</CODE>
. Each such code refers to some constraint such as “any term which is a subtype of ‘hepatitis’ in the ICD9AM terminology”; the constraint definitions do not provide the constraints themselves, but define the <EM CLASS="Emphasis">
meanings</EM>
 of such constraints, in a manner comprehensible to human beings, and usable in GUI applications. This may seem a superfluous thing to do, but in fact it is quite important. Firstly, term constraints can only be expressed with respect to particular terminologies - a constraint for “kind of hepatitis” would be expressed in different ways for each terminology which the archetype is bound to. For this reason, the actual constraints are defined in the <CODE CLASS="Code">
term_bindings</CODE>
 section. An example of a constraint term definition for the hepatitis constraint is as follows:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1141052"></A>[“ac1015”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136123"></A>	text = &lt;&quot;type of hepatitis&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122198"></A>	description = &lt;&quot;any term which means a kind of viral hepatitis&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122199"></A>&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1122208"></A>Note that while it often seems tempting to use classification codes, e.g. from the ICD vocabularies, these will rarely be much use in terminology or constraint definitions, because it is nearly always <EM CLASS="Emphasis">
descriptive</EM>
, not classificatory terms which are needed.</P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1121641"></A>8.11.4	<A NAME="39544"></A>Term_bindings Section</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1122219"></A>This section is used to describe the equivalences between archetype local terms and terms and value sets found in external terminologies. Bindings are expressed as URIs.</P>
<OL>
<LI CLASS="TBD">
<A NAME="pgfId-1151181"></A>note that the actual URIs here are probably not yet correct; refer to IHTSDO / Mayo / CTS2 etc</LI>
</OL>
<P CLASS="Body">
<A NAME="pgfId-1151174"></A>The main purpose for allowing query engines to search for an instance of some external term to determine what equivalent to use in the archetype. </P>
<P CLASS="Hdr4U">
<A NAME="pgfId-1146168"></A>Global Term Bindings</P>
<P CLASS="BodyFirst">
<A NAME="pgfId-1146172"></A>There are two types of term bindings that can be used, ‘global’ and path-based. The former is where an external term is bound directly to an archetype local term, and the binding holds globally throughout the archetype. In many cases, archetype terms only appear once in an archetype, but in some archetypes, at-codes are reused throughout the archetype. In such cases, a global binding asserts that the correspondence is true in all locations. A typical global term binding section resembles the following:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1122223"></A>term_bindings = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141062"></A>	[&quot;umls&quot;] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141069"></A>		[&quot;id1&quot;] = &lt;http://umls.nlm.edu/id/C124305&gt; -- apgar result</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122225"></A>		[&quot;id2&quot;] = &lt;.../0000000&gt; -- 1-minute event </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122226"></A>		[&quot;id4&quot;] = &lt;.../C234305&gt; -- cardiac score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122227"></A>		[&quot;id5&quot;] = &lt;.../C232405&gt; -- respiratory score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136157"></A>		[&quot;id6&quot;] = &lt;.../C254305&gt; -- muscle tone score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136158"></A>		[&quot;id7&quot;] = &lt;.../C987305&gt; -- reflex response score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1136159"></A>		[&quot;id8&quot;] = &lt;.../C189305&gt; -- color score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122231"></A>		[&quot;id9&quot;] = &lt;.../C187305&gt; -- apgar score</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122232"></A>		[&quot;id10&quot;] = &lt;.../C325305&gt; -- 2-minute apgar</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122233"></A>		[&quot;id11&quot;] = &lt;.../C725354&gt; -- 5-minute apgar</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141162"></A>		[&quot;id12&quot;] = &lt;.../C224305&gt; -- 10-minute apgar</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141171"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141163"></A>&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1141164"></A>Each entry indicates which term in an external terminology is equivalent to the archetype internal codes. Note that not all internal codes necessarily have equivalents: for this reason, a terminology binding is assumed to be valid even if it does not contain all of the internal codes.</P>
<P CLASS="Hdr4U">
<A NAME="pgfId-1146182"></A>Path-based Bindings</P>
<P CLASS="BodyFirst">
<A NAME="pgfId-1146186"></A>The second kind of binding is one between an archetype path and an external code. This occurs commonly for archetypes where a term us re-used at the leaf level. For example, in the binding example below, the id4 code represents ‘temperature’ and the codes id3, id5, id6 etc correspond to various times such as ‘any’, 1-hour average, 1-hour maximum and so on. Some terminologies (notably LOINC, the laboratory terminology in this example) define ‘pre-coordinated’ codes, such as ‘1 hour body temperature’; these clearly correspond not to single codes such as id4 in the archetype, but to whole paths. In such cases, the key in each term binding row is a full path rather than a single term.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1147836"></A>[&quot;LNC205&quot;] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147837"></A>	[&quot;/data[id2]/events[id3]/data[id1]/item[id4]&quot;] = &lt;http://loinc.org/ver=LNC205/id=8310-5&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147838"></A>	[&quot;/data[id2]/events[id5]/data[id1]/item[id4]&quot;] = &lt;.../8321-2&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147833"></A>	[&quot;/data[id2]/events[id6]/data[id1]/item[id4]&quot;] = &lt;.../8311-3&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146012"></A>	[&quot;/data[id2]/events[id7]/data[id1]/item[id4]&quot;] = &lt;.../8316-2&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146013"></A>	[&quot;/data[id2]/events[id8]/data[id1]/item[id4]&quot;] = &lt;.../8332-0&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145990"></A>	[&quot;/data[id2]/events[id9]/data[id1]/item[id4]&quot;] = &lt;.../8312-1&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145991"></A>	[&quot;/data[id2]/events[id17]/data[id1]/item[id4]&quot;] = &lt;.../8325-3&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145992"></A>	[&quot;/data[id2]/events[id19]/data[id1]/item[id4]&quot;] = &lt;.../8320-4&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145994"></A>&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1145978"></A>&nbsp;</PRE>
<P CLASS="BodyFirst">
<A NAME="pgfId-1121653"></A>Bindings to external value sets are also included in the bindings section, also as URIs:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1121656"></A>term_bindings = &lt; </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1122492"></A>	[“snomed_ct”]	 = &lt;			</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141195"></A>		[“ac1”] = &lt;				http://terminology.org?query_id=12345			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141237"></A>		[“ac2”] = &lt;http://terminology.org?query_id=678910&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141233"></A>	&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1121664"></A>&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1121654"></A>In this example, each local constraint code is formally defined to refer to a query defined in a terminology service, in this case, a terminology service that can interrogate the Snomed-CT terminology. </P>
</DIV>
<DIV>
<H6 CLASS="Hdr3">
<A NAME="pgfId-1151218"></A>8.11.5	Deprecated Elements</H6>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151219"></A>In the 1.4 release of ADL, there were two separate bindings sections, <CODE CLASS="Code">
term_bindings </CODE>
and <CODE CLASS="Code">
constraint_bindings</CODE>
. These have been merged into one section, <CODE CLASS="Code">
bindings</CODE>
.</P>
<P CLASS="Body">
<A NAME="pgfId-1151220"></A>Additionally in ADL 1.4, a <CODE CLASS="Code">
terminologies_available</CODE>
 header statement was required to identify all terminologies for which <CODE CLASS="Code">
term_bindings</CODE>
 sections have been written. For example:</P>
<PRE CLASS="CCode"><A NAME="pgfId-1149215"></A>	terminologies_available = &lt;“snomed_ct”, “loinc”&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1149241"></A>This is no longer required. In archetypes that have it, it is ignored, and should not be included in ADL 1.5 or later syntax output serialisation.</P>
</DIV>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1137247"></A>Annotations Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1146855"></A>The annotations section of an archetype or template provides a place for node-level meta-data to be added to the archetype. This can be used during the design phase to track dependencies, design decisions, and specific resource references. Each annotation is keyed by the path of the node being annotated, or a pure RM path, and may have any number of tagged elements. A typical annotations section looks as follows.</P>
<PRE CLASS="CCode"><A NAME="pgfId-1147580"></A>annotations </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147581"></A>	items = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151424"></A>		[“en”] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151425"></A>			items = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1151426"></A>				[&quot;/data/items[at0.37]/items[at0.38]/value&quot;] = &lt; -- Clin st. / stage</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147850"></A>					items = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147851"></A>						[&quot;messaging requirement&quot;] = </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147852"></A>										&lt;&quot;= ‘staging’ field in msg type 2345&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146814"></A>						[&quot;guideline&quot;] = </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147633"></A>										&lt;&quot;http://guidelines.org/gl24.html#staging&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146820"></A>						[&quot;data dict equivalent&quot;] = &lt;&quot;NHS data item aaa.1&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147600"></A>					&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147640"></A>				&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147780"></A>				[&quot;/data/items[at0.37]/items[at0.39]/value&quot;] = &lt; -- Clin st. / </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147781"></A>Tumour</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147782"></A>					items = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146836"></A>						[&quot;message requirement&quot;] = &lt;&quot;tumour field in msg type 2345&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146837"></A>						[&quot;guideline&quot;] = &lt;&quot;http://guidelines.org/gl24.html#mass&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146838"></A>						[&quot;data dict equivalent&quot;] = &lt;&quot;NHS data item aaa.2&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147656"></A>					&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1147649"></A>				&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146839"></A>			&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146840"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146734"></A>	&gt;</PRE>
<P CLASS="Body">
<A NAME="pgfId-1147663"></A>Annotations are defined as a separate section that can be easily removed in production versions of an archetype or template, and/or ignored in the generation of digital signatures.</P>
<P CLASS="Body">
<A NAME="pgfId-1148114"></A>Typically annotations are used to document a particular node within an archetype, specified by its (unique) archetype path. In some cases, the archetype (or tempate) author wants to document the use of a reference model attribute that is not constrained in the archetype (and therefore does not have an archetype path as such). In this case, the path will just be a valid RM path, i.e. a path relative to the top-level object of the archetype, and containing no at-codes. </P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1146733"></A>Revision History Section</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1140359"></A>The revision history section of an archetype shows the audit history of changes to the archetype, and is expressed in ODIN syntax. It is optional, and is included at the end of the archetype, since it does not contain content of direct interest to archetype authors, and will monotonically grow in size. Where archetypes are stored in a version-controlled repository such as CVS or some commercial product, the revision history section would normally be regenerated each time by the authoring software, e.g. via processing of the output of the ‘prs’ command used with SCCS files, or ‘rlog’ for RCS files. The following shows a typical example, with entries in most-recent-first order (although technically speaking, the order is irrelevant to ADL).</P>
<PRE CLASS="CCode"><A NAME="pgfId-1146737"></A>revision_history </PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146738"></A>	revision_history = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146739"></A>		[&quot;1.57&quot;] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1146740"></A>			committer = &lt;&quot;Miriam Hanoosh&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140666"></A>			committer_organisation = &lt;&quot;AIHW.org.au&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140648"></A>			time_committed = &lt;2004-11-02 09:31:04+1000&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140675"></A>			revision = &lt;&quot;1.2&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140703"></A>			reason = &lt;&quot;Added social history section&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140679"></A>			change_type = &lt;&quot;Modification&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140708"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1141588"></A>		-- etc</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140719"></A>		[&quot;1.1&quot;] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140720"></A>			committer = &lt;&quot;Enrico Barrios&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140721"></A>			committer_organisation = &lt;&quot;AIHW.org.au&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140722"></A>			time_committed = &lt;2004-09-24 11:57:00+1000&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140723"></A>			revision = &lt;&quot;1.1&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140724"></A>			reason = &lt;&quot;Updated HbA1C test result reference&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140725"></A>			change_type = &lt;&quot;Modification&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140726"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140734"></A>		[&quot;1.0&quot;] = &lt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140735"></A>			committer = &lt;&quot;Enrico Barrios&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140736"></A>			committer_organisation = &lt;&quot;AIHW.org.au&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140737"></A>			time_committed = &lt;2004-09-14 16:05:00+1000&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140738"></A>			revision = &lt;&quot;1.0&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140739"></A>			reason = &lt;&quot;Initial Writing&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140740"></A>			change_type = &lt;&quot;Creation&quot;&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140741"></A>		&gt;</PRE>
<PRE CLASS="CCode"><A NAME="pgfId-1140785"></A>	&gt;</PRE>
</DIV>
</DIV>
<DIV>
<H4 CLASS="Hdr1">
<A NAME="pgfId-1140068"></A><A NAME="33142"></A>Terminology Integration<DIV>
<IMG SRC="main-1.png">
</DIV>
</H4>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151604"></A>This section describes how archetype constraints on terminological entities can be expressed in their various forms, and how these constraints are resolved to concrete sets of terms.</P>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1151615"></A>Source-form Constraints</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151635"></A>&nbsp;</P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1151625"></A>Expanded Constraints</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151652"></A>&nbsp;</P>
</DIV>
<DIV>
<H5 CLASS="Hdr2">
<A NAME="pgfId-1151642"></A>Constraint Resolution</H5>
<P CLASS="BodyFirst">
<A NAME="pgfId-1151659"></A>&nbsp;</P>
<P CLASS="Body">
<A NAME="pgfId-1151667"></A>&nbsp;</P>
<P CLASS="Body">
<A NAME="pgfId-1151686"></A>Terminology constraints are an alternative to enumeration of value sets within an archetype. Inline enumeration will work perfectly well in a technical sense, but has at least two limitations. Firstly, the intended set of values allowed for the attribute may change over time (e.g. as has happened with ‘types of hepatitis’ since 1980), and since the authoritative resource is elsewhere, the archetype has to be continually updated. With a large repository of archetypes, each containing inline coded term constraints, this approach is likely to be unsustainable and error-prone. Secondly, the best means of defining the value set is in general not likely to be via enumeration of the individual terms, but in the form of a semantic expression that can be evaluated against the external resource. This is because the value set is typically logically specified in terms of inclusions, exclusions, conjunctions and disjunctions of general categories.</P>
<UL>
<P CLASS="Discussion">
<A NAME="pgfId-1151687"></A>Consider for example the value set logically defined as “any bacterial infection of the lung”. The possible values would be codes from a target terminology, corresponding to numerous strains of pneumococcus, staphlycoccus and so on, but not including species that are never found in the lung. Rather than enumerate the list of codes corresponding to this value set (which is likely to be quite large), the archetype author is more likely to rely on semantic links within the external terminology to express the set; a query such as ‘is-a bacteria and has-site lung’ is definable against the SNOMED-CT terminology for example.</P>
</UL>
<P CLASS="DiscussionCont">
<A NAME="pgfId-1151688"></A>In a similar way, other value sets, including for quantitative values, are likely to be specified by queries or formal expressions, and evaluated by an external knowledge service. Examples include “any unit of pressure” and “normal range values for serum sodium”.</P>
<P CLASS="DiscussionCont">
<A NAME="pgfId-1151689"></A>In such cases, expressing the terminology constraint could be done by including the query or other formal expression directly within the archetype itself. However, experience shows that this is problematic in various ways. Firstly, there is little if any standardisation in such formal value set expressions or queries for use with knowledge services - two archetype authors could easily create competing syntactical expressions for the same logical constraint. A second problem is that errors might be made in the query expression itself, or the expression may be correct at the time of authoring, but need subsequent adjustment as the relevant knowledge resource grows and changes. The consequence of this is the same as for a value set enumerated inline - it is unlikely to be sustainable for large numbers of archetypes. </P>
<P CLASS="DiscussionCont">
<A NAME="pgfId-1151690"></A>These problems are not accidental: a query with respect to a terminological, ontological or other knowledge resource is most likely to be authored correctly by maintainers or experts of the knowledge resource, rather than archetype authors; it may well be altered over time due to improvements in the query formalism itself.</P>
<P CLASS="Body">
<A NAME="pgfId-1151678"></A>&nbsp;</P>
</DIV>
</DIV>
</BODY>
</HTML>
